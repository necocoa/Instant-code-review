h1 新規投稿

= form_with model: @post, local: true do |f|
  = render 'shared/form_errors', resource: @post
  .form-group
    = f.label :title
    = f.text_field :title, class: 'form-control', required: true
  .form-group
    #editor
      = f.label :body
      = f.text_area :body, rows: 20, class: 'form-control', required: true, 'v-model': 'input_preview',
                           placeholder: "投稿内容を入力してください\n※Markdown記法が利用できます"
      .md-preview.my-4.p-4.rounded v-html='marked_preview'

  .form-group
    = f.submit '投稿する', class: 'btn btn-primary'

javascript:
  new Vue({
    el: '#editor',
    data: {
      input_preview: "#{@post.body}",
    },
    computed: {
      marked_preview: function () {
        return marked(this.input_preview);
      },
    },
    created: function () {
      marked.setOptions({
        highlight: (code, lang) => {
          return hljs.highlightAuto(code, [lang]).value;
        },
      });
    },
  });
